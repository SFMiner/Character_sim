[gd_scene load_steps=5 format=3 uid="uid://dialogue_sim_main"]

[ext_resource type="Script" uid="uid://dialogue_ui_script" path="res://ui/dialogue_ui.gd" id="1_ui"]
[ext_resource type="Script" uid="uid://character_node_script" path="res://dialogue/character_node.gd" id="2_char"]
[ext_resource type="Script" uid="uid://character_profile_script" path="res://dialogue/character_profile.gd" id="3_profile"]
[ext_resource type="Resource" path="res://knowledge/npc_memory_archivist_7.tres" id="4_memory"]

[sub_resource type="Resource" id="Resource_profile"]
script = ExtResource("3_profile")
character_name = "Archivist-7"
character_type = "llm"
verbosity = "medium"
hedge_intensity = 0.7
forbidden_topics = Array[String](["magic", "sorcery", "spells"])
preferred_skeletons = Array[String](["structured_answer", "llm_refusal", "llm_ack"])

[node name="Main" type="Control"]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
script = ExtResource("1_ui")

[node name="ColorRect" type="ColorRect" parent="."]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
color = Color(0.12, 0.12, 0.15, 1)

[node name="VBoxContainer" type="VBoxContainer" parent="."]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = 20.0
offset_top = 20.0
offset_right = -20.0
offset_bottom = -20.0
theme_override_constants/separation = 10

[node name="HeaderContainer" type="HBoxContainer" parent="VBoxContainer"]
layout_mode = 2

[node name="CharacterLabel" type="Label" parent="VBoxContainer/HeaderContainer"]
layout_mode = 2
size_flags_horizontal = 3
theme_override_font_sizes/font_size = 18
text = "Talking to: Archivist-7 (llm)"

[node name="TurnLabel" type="Label" parent="VBoxContainer/HeaderContainer"]
layout_mode = 2
theme_override_font_sizes/font_size = 18
text = "Turn: 0"

[node name="OutputDisplay" type="RichTextLabel" parent="VBoxContainer"]
layout_mode = 2
size_flags_vertical = 3
bbcode_enabled = true
text = ""
scroll_following = true

[node name="DebugPanel" type="RichTextLabel" parent="VBoxContainer"]
visible = false
custom_minimum_size = Vector2(0, 120)
layout_mode = 2
bbcode_enabled = true
text = ""

[node name="InputContainer" type="HBoxContainer" parent="VBoxContainer"]
layout_mode = 2

[node name="InputField" type="LineEdit" parent="VBoxContainer/InputContainer"]
layout_mode = 2
size_flags_horizontal = 3
placeholder_text = "Type your message here..."

[node name="SubmitButton" type="Button" parent="VBoxContainer/InputContainer"]
layout_mode = 2
text = "Submit"

[node name="DebugToggle" type="Button" parent="VBoxContainer/InputContainer"]
layout_mode = 2
text = "Debug"

[node name="CharacterNode" type="Node" parent="."]
script = ExtResource("2_char")
profile = SubResource("Resource_profile")
initial_memory = ExtResource("4_memory")

[connection signal="pressed" from="VBoxContainer/InputContainer/DebugToggle" to="." method="toggle_debug"]
